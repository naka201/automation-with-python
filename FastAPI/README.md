# FastAPI タスク自動化プロジェクト

このプロジェクトは、FastAPIを使用して業務タスクを自動化するためのWeb APIを提供します。

**・F-projectに移行予定**

## 機能

### 1. 差額チェック機能
商品カテゴリ（バッグ、時計、宝石）ごとに異なる条件で差額チェックを行い、条件に合致する行を黄色でハイライトします。

#### バッグの条件
- MAX金額：100万以上、差額：50万以上
- MAX金額：50万以上100万未満、差額：20万以上
- MAX金額：30万以上50万未満、差額：10万以上
- MAX金額：10万以上30万未満、差額：5万以上
- MAX金額：1万以上10万未満、差額：3万以上
- MAX金額：1万以下、差額：9000円以上

#### 時計の条件
- MAX金額：100万以上、差額：20万以上
- MAX金額：10万以上100万未満、差額：10万以上
- MAX金額：1万以上10万未満、差額：5万以上
- MAX金額：1円以上1万未満、差額：5000円以上

#### 宝石の条件
- MAX金額：50万以上、差額：20万以上
- MAX金額：30万以上50万未満、差額：10万以上
- MAX金額：10万以上30万未満、差額：3万以上
- MAX金額：1万以上10万未満、差額：1万以上
- MAX金額：1円以上1万未満、差額：3500円以上

### 2. 箱番作成機能
（実装予定）

## 使用方法

### API エンドポイント

1. タスク実行エンドポイント
```
POST /execute_task
```
パラメータ：
- task: 実行するタスク（"差額チェック" または "箱番作成"）
- file: Excelファイル（.xlsx）

### 実行方法

1. 必要なパッケージのインストール
```bash
pip install fastapi uvicorn pandas openpyxl python-multipart
```

2. サーバーの起動
```bash
uvicorn main:app --reload
```

3. APIの使用
- ブラウザで `http://localhost:8000` にアクセス
- Swagger UIで `http://localhost:8000/docs` にアクセス

## 出力

- 処理されたファイルは `output_files` ディレクトリに保存されます
- 差額チェックの結果は、元のファイル名に「_チェック後」を付加したファイルとして保存されます

## 注意事項

- 入力ファイルはExcel形式（.xlsx）である必要があります
- ファイル名に商品カテゴリ（バッグ、時計、宝石）が含まれている必要があります
